/*! Charcoal-Validate 05-09-2014 */
var Charcoal=Charcoal||{};Charcoal.Form=Charcoal.Form||{},Charcoal.Form.Validate=Charcoal.Form.Validate||{},function(a){"use strict";a.fn.lvalidate=function(b){var c={requiredClass:"required",similarClass:"similar",requiredGroupClass:"required-group",regExpClass:"regexp",onError:function(){},onSuccess:function(){},onFirstError:function(){},custom_validation:function(){return!0},valid:function(){},invalid:function(){}};if("string"==typeof b&&a(this).data("lvalidate")){var d=a(this).data("lvalidate");switch(b){case"validate":return d.validate(),this;default:return this}}var e=a.extend(c,b);return a(this).each(function(){var b=new Charcoal.Form.Validate(a(this),e);a(this).data("lvalidate",b)}),a(this).on("click","[type=submit]",function(b){b.preventDefault();var c=a(this).parents("form"),d=c.data("lvalidate");d.validate()}),this}}(jQuery),Charcoal.Form.Validate=function(a,b){this.obj=a,this.settings=b||{},this.invalidInputs=[],this.validate=function(){this.form=this.obj;{var a=(this.form.find("."+this.settings.requiredClass),this.form.find("."+this.settings.similarClass)),b=this.form.find("."+this.settings.requiredGroupClass);this.form.find("."+this.settings.regExpClass)}this.form.find(".error").removeClass("error");var c=this,d=!0,e=!0,f="input, select, textarea",g=this.form.find(f);g.each(function(){var a=$(this),b=c.validate_input(a);d=d&&!b,!d&&e&&(e=!1,c.settings.onFirstError(a,"First Error"))}),a.each(function(){var a=c.validate_input($(this),"similar");d=d&&!a,!d&&e&&(e=!1,c.settings.onFirstError($(this),"First Error"))});if(b.each(function(){var a=$(this),b=a.data(),e=c.validate_input($(this),"required-group",b);d=d&&!e}),d&&"function"==typeof this.settings.custom_validation){var h=this.settings.custom_validation(this);d=d&&h,!d&&e&&(e=!1,c.settings.onFirstError(!1,"Custom Error"))}d?this.settings.valid(this.obj):this.settings.invalid(this.obj)},this.default_rule=function(){return"required"},this.validate_input=function(a,b,c){c=c||{},c.rules=b?[b]:null;var d=new Charcoal.Form.Validate.Input(this,a,c);return d.validate()},this.error=function(a,b,c){return this.settings.onError(a,b,c),!1},this.success=function(a,b,c){return this.settings.onSuccess(a,b,c),!0},this.listeners=function(){},this.isEmptySmart=function(a){var b=a,c=b.prop("tagName"),d=b.attr("type"),e=b.attr("name");if("INPUT"==c){if("text"==d||"password"==d)return this.isEmpty(b);if("radio"==d){var f=this.obj.find("input[name="+e+"]");return this.isRadioEmpty(f)}if("checkbox"==d)return!this.isChecked(b);if("email"==d)return!this.isValidEmail(b)}return"TEXTAREA"==c?this.isEmpty(b):"SELECT"==c?this.isSelectEmpty(b):void 0},this.isEmpty=function(a){return""===a.val()||!a.val()||"-1"==a.val()},this.isValidEmail=function(a){var b=/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i;return b.test(a.val())},this.isSelectEmpty=function(a){return this.isEmpty(a.find("option:selected"))},this.isChecked=function(a){return a.is(":checked")},this.isRadioEmpty=function(a){var b=!0;return a.each(function(){$(this);$(this).is(":checked")&&(b=!1)}),b},this.isDifferent=function(a){for(var b=!1,c="",d=this,e=0;e<a.length;e++)0!==e?c!=d.get_value(a[e])&&(b=!0):c=d.get_value(a[e]);return b},this.get_value=function(a){var b=a,c=b.prop("tagName"),d=b.attr("type"),e=b.attr("name");if("INPUT"==c){if("text"==d||"email"==d||"password"==d||"tel"==d)return b.val();if("checkbox"==d)return b.is(":checked")?b.val():"";if("radio"==d){var f=this.obj.find("input[name="+e+"]");return f.each(function(){return $(this).is(":checked")?b.val():void 0}),""}}return"TEXTAREA"==c?b.val():"SELECT"==c?b.find("option:selected").val():void 0}},Charcoal.Form.Validate.Input=function(a,b,c){this.v=a,this.types={},this.input=b,this.options=c||{},this.results={error:[],warning:[],success:[]},this.error=function(a,b){return this.results.error.push(a),this.v.error(this.input,a,b)},this.succes=function(a,b){return this.results.success.push(a),this.v.success(this.input,a,b)},this.detect_rules=function(){var a,b=this.input.prop("tagName"),c=this.input.attr("type"),d=this.input.data();return a="string"==typeof d.rules||d.rules instanceof String?d.rules.split(" "):d.rules instanceof Array?d.rules:[],"INPUT"==b&&("email"==c&&a.push("email"),("undefined"!=typeof d.luhn||"undefined"!=typeof d.creditCard)&&a.push("credit-card"),"undefined"!=typeof d.regexp&&a.push("regexp")),this.input.attr("required")&&a.push("required"),a.length>0?a:[]},this.validate=function(a){a=a||{},a=$.extend(this.options,a);{var c=b,d=this;c.data()}a.rules=a.rules||{},rules=$.extend(this.detect_rules(),this.options.rules);var e=!0;for(var f in rules){var g=rules[f],h={};if(void 0!==Charcoal.Form.Validate.Rule.types[g]){var i=new Charcoal.Form.Validate.Rule.types[g](this,h),j=i.validate(this);j||(e=!1)}if("similar"==g){if(c.attr("data-related")){var k=c.attr("data-related"),l=this.form.find("[name="+k+"]");return this.isDifferent([c,l])?d.error(l,"similar",c):d.success(l,"Similar")}return d.success(c,"no-related-elements")}if("required-group"==g&&a){var m,n=!1;a.required.indexOf("[]")>0?(n=!0,m=a.required.substr(0,a.required.indexOf("[]"))):m=a.required.replace(" ","").split(",");var o=!1,p=[],q=n?d.form.find("[name^="+m+"]"):"";if(q.length)q.each(function(){var a=$(this);if(a.length&&p.push(a),!o&&a.length&&!o){var b=!d.isEmptySmart(a);o=!!b}});else for(var r=0;r<m.length;r++){var s=d.form.find("[name="+m[r]+"]");if(s.length&&p.push(s),!o&&s.length&&!o){var t=!d.isEmptySmart(s);o=!!t}}return o?d.success(c,"required_group",p):d.error(c,"required_group",p)}}return e},this.get_value=function(){var a=this.input,b=a.prop("tagName"),c=a.attr("type");if("INPUT"==b){if("checkbox"==c)return a.is(":checked")?a.val():"";if("radio"==c){var d=a.attr("name"),e=this.obj.find("input[name="+d+"]");return e.each(function(){return $(this).is(":checked")?a.val():void 0}),""}return a.val()}return"TEXTAREA"==b?a.val():"SELECT"==b?a.find("option:selected").val():void 0},this.get_data=function(){var a=this.input;return a.data()}},Charcoal.Form.Validate.Rule=function(a,b,c){this.v=a,this.input=b,this.types={};var d={};this.options=$.extend(d,c)},Charcoal.Form.Validate.Rule.prototype.error=function(a,b,c){return this.v?this.v.error(a,b,c):!1},Charcoal.Form.Validate.Rule.prototype.success=function(){return this.v?!0:!0},Charcoal.Form.Validate.Rule.Credit_Card=function(a,b){this.v=a;var c={};this.options=$.extend(c,b)},Charcoal.Form.Validate.Rule.Credit_Card.prototype=new Charcoal.Form.Validate.Rule,Charcoal.Form.Validate.Rule.Credit_Card.prototype.constructor=Charcoal.Form.Validate.Rule,Charcoal.Form.Validate.Rule.types=Charcoal.Form.Validate.Rule.types||{},Charcoal.Form.Validate.Rule.types.credit_card=Charcoal.Form.Validate.Rule.Credit_Card,Charcoal.Form.Validate.Rule.types["credit-card"]=Charcoal.Form.Validate.Rule.Credit_Card,Charcoal.Form.Validate.Rule.types.luhn=Charcoal.Form.Validate.Rule.Credit_Card,Charcoal.Form.Validate.Rule.Credit_Card.prototype.check_luhn=function(a){if(!a)return!1;if(/[^0-9-\s]+/.test(a))return!1;var b=0,c=0,d=!1;a=a.replace(/\D/g,"");for(var e=a.length-1;e>=0;e--){var f=a.charAt(e);c=parseInt(f,10),d&&(c*=2)>9&&(c-=9),b+=c,d=!d}return b%10===0},Charcoal.Form.Validate.Rule.Credit_Card.prototype.validate=function(a){return this.check_luhn(a.get_value())?this.success(a,"credit-card"):this.error(a,"credit-card")},Charcoal.Form.Validate.Rule.Email=function(a,b){this.v=a;var c={};this.options=$.extend(c,b)},Charcoal.Form.Validate.Rule.Email.prototype=new Charcoal.Form.Validate.Rule,Charcoal.Form.Validate.Rule.Email.prototype.constructor=Charcoal.Form.Validate.Rule,Charcoal.Form.Validate.Rule.types=Charcoal.Form.Validate.Rule.types||{},Charcoal.Form.Validate.Rule.types.email=Charcoal.Form.Validate.Rule.Email,Charcoal.Form.Validate.Rule.Email.prototype.validate=function(a){var b=a.get_value();if(!b)return this.success(a,"email");var c=/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i,d=c.test(b);return d?this.success(a,"email"):this.error(a,"email")},Charcoal.Form.Validate.Rule.Empty=function(a,b){this.v=a;var c={};this.options=$.extend(c,b)},Charcoal.Form.Validate.Rule.Empty.prototype=new Charcoal.Form.Validate.Rule,Charcoal.Form.Validate.Rule.Empty.prototype.constructor=Charcoal.Form.Validate.Rule,Charcoal.Form.Validate.Rule.types=Charcoal.Form.Validate.Rule.types||{},Charcoal.Form.Validate.Rule.types.empty=Charcoal.Form.Validate.Rule.Empty,Charcoal.Form.Validate.Rule.types.required=Charcoal.Form.Validate.Rule.Empty,Charcoal.Form.Validate.Rule.Empty.prototype.validate=function(a){this.is_empty=function(a){return""===a.val()||!a.val()||"-1"==a.val()},this.is_element_empty=function(a){var b=a.input,c=b.prop("tagName"),d=b.attr("type"),e=b.attr("name");if("INPUT"==c){if("radio"==d){var f=b.parents("form").find("input[name="+e+"]:checked");return!f.length}return"checkbox"==d?b.is(":checked"):""===b.val()||!b.val()}return"TEXTAREA"==c?""===b.val()||!b.val()||"-1"==b.val():"SELECT"==c?this.is_empty(b.find("option:selected")):void 0};var b=this.is_element_empty(a);return b?this.error(a,"empty"):this.success(a,"ok")},Charcoal.Form.Validate.Rule.Max_Length=function(a,b){this.v=a;var c={"max-length":null};this.options=$.extend(c,b)},Charcoal.Form.Validate.Rule.Max_Length.prototype=new Charcoal.Form.Validate.Rule,Charcoal.Form.Validate.Rule.Max_Length.prototype.constructor=Charcoal.Form.Validate.Rule,Charcoal.Form.Validate.Rule.types=Charcoal.Form.Validate.Rule.types||{},Charcoal.Form.Validate.Rule.types.max_length=Charcoal.Form.Validate.Rule.Max_Length,Charcoal.Form.Validate.Rule.types["max-length"]=Charcoal.Form.Validate.Rule.Max_Length,Charcoal.Form.Validate.Rule.Max_Length.prototype.detect_rule_options=function(a){var b=a.get_data();return b.maxLength&&(b["max-length"]=b.maxLength),b},Charcoal.Form.Validate.Rule.Max_Length.prototype.validate=function(a){var b=$.extend(this.options,this.detect_rule_options(a));if(!b["max-length"])return this.error(a,"setup-max-length-unspecified");var c=a.get_value(),d=c.length>b["max-length"];return d?this.success(a,"max-length"):this.error(a,"max-length")},Charcoal.Form.Validate.Rule.Regexp=function(a,b){this.v=a;var c={regexp:null,modifiers:"gi"};this.options=$.extend(c,b)},Charcoal.Form.Validate.Rule.Regexp.prototype=new Charcoal.Form.Validate.Rule,Charcoal.Form.Validate.Rule.Regexp.prototype.constructor=Charcoal.Form.Validate.Rule,Charcoal.Form.Validate.Rule.types=Charcoal.Form.Validate.Rule.types||{},Charcoal.Form.Validate.Rule.types.regexp=Charcoal.Form.Validate.Rule.Regexp,Charcoal.Form.Validate.Rule.Regexp.prototype.detect_rule_options=function(a){var b=a.get_data();return b},Charcoal.Form.Validate.Rule.Regexp.prototype.validate=function(a){var b=$.extend(this.options,this.detect_rule_options(a));if(null===b.regexp)return this.error(a,"setup-regexp-missing");var c=new RegExp(b.regexp,b.modifiers),d=c.test(a.get_value());return d?this.success(a,"regexp"):this.error(a,"regexp")};